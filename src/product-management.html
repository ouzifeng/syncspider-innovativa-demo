<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
    />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Products | Innovativa</title>
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='.9em' font-size='90'%3EðŸ“¦%3C/text%3E%3C/svg%3E">
  </head>
  <body
    x-data="{ page: 'products', 'loaded': true, 'darkMode': false, 'stickyMenu': false, 'sidebarToggle': false, 'scrollTop': false }"
    x-init="
         darkMode = JSON.parse(localStorage.getItem('darkMode'));
         $watch('darkMode', value => localStorage.setItem('darkMode', JSON.stringify(value)))"
    :class="{'dark bg-gray-900': darkMode === true}"
  >
    <!-- ===== Preloader Start ===== -->
    <include src="./partials/preloader.html"></include>
    <!-- ===== Preloader End ===== -->

    <!-- ===== Page Wrapper Start ===== -->
    <div class="flex h-screen overflow-hidden">
      <!-- ===== Sidebar Start ===== -->
      <include src="./partials/sidebar.html"></include>
      <!-- ===== Sidebar End ===== -->

      <!-- ===== Content Area Start ===== -->
      <div
        class="relative flex flex-col flex-1 overflow-x-hidden overflow-y-auto"
      >
        <!-- Small Device Overlay Start -->
        <include src="./partials/overlay.html" />
        <!-- Small Device Overlay End -->

        <!-- ===== Header Start ===== -->
        <include src="./partials/header.html" />
        <!-- ===== Header End ===== -->

        <!-- ===== Main Content Start ===== -->
        <main>
          <div class="p-4 mx-auto max-w-screen-2xl md:p-6 2xl:p-10">
            <!-- Products Component -->
            <div
              x-data="{
                // Filters
                searchQuery: '',
                filterClient: 'all',

                // Modal state
                pricingModal: false,
                selectedProduct: null,

                // Products with stored quotations (dual pricing: supplier + client)
                products: [
                  {
                    id: 'PRD-001',
                    sku: 'WG-PRO-001',
                    name: 'Winter Gloves Pro',
                    description: 'Waterproof winter gloves with touchscreen capability',
                    client: 'GloveWorld Store',
                    status: 'active',
                    createdAt: '2024-11-15',
                    totalOrders: 847,
                    pricing: {
                      'US': { '1': { single: { supplier: 7.20, client: 9.50 } }, '3': { single: { supplier: 6.40, client: 8.50 } }, '5': { single: { supplier: 5.80, client: 7.80 } } },
                      'UK': { '1': { single: { supplier: 7.00, client: 9.20 } }, '3': { single: { supplier: 6.20, client: 8.20 } }, '5': { single: { supplier: 5.60, client: 7.50 } } },
                      'DE': { '1': { single: { supplier: 7.50, client: 9.80 } }, '3': { single: { supplier: 6.70, client: 8.80 } }, '5': { single: { supplier: 6.00, client: 8.00 } } }
                    },
                    countries: ['US', 'UK', 'DE'],
                    quantities: [1, 3, 5],
                    shippingType: 'single'
                  },
                  {
                    id: 'PRD-002',
                    sku: 'USB-HUB-7',
                    name: 'USB-C Hub 7-in-1',
                    description: '7-port USB-C hub with HDMI and SD card reader',
                    client: 'TechGadgets Pro',
                    status: 'active',
                    createdAt: '2024-10-20',
                    totalOrders: 1523,
                    pricing: {
                      'US': { '1': { single: { supplier: 9.00, client: 12.00 }, upsell: { supplier: 7.80, client: 10.50 } }, '3': { single: { supplier: 8.20, client: 11.00 }, upsell: { supplier: 7.00, client: 9.50 } }, '5': { single: { supplier: 7.40, client: 10.00 }, upsell: { supplier: 6.20, client: 8.50 } } },
                      'UK': { '1': { single: { supplier: 9.40, client: 12.50 }, upsell: { supplier: 8.20, client: 11.00 } }, '3': { single: { supplier: 8.60, client: 11.50 }, upsell: { supplier: 7.40, client: 10.00 } }, '5': { single: { supplier: 7.80, client: 10.50 }, upsell: { supplier: 6.60, client: 9.00 } } }
                    },
                    countries: ['US', 'UK'],
                    quantities: [1, 3, 5],
                    shippingType: 'both'
                  },
                  {
                    id: 'PRD-003',
                    sku: 'PDB-L-001',
                    name: 'Premium Dog Bed - Large',
                    description: 'Orthopedic memory foam dog bed, large size',
                    client: 'PetSupplies Direct',
                    status: 'active',
                    createdAt: '2024-09-10',
                    totalOrders: 2341,
                    pricing: {
                      'UK': { '1': { single: { supplier: 17.00, client: 22.50 } }, '3': { single: { supplier: 15.00, client: 20.00 } }, '5': { single: { supplier: 13.50, client: 18.00 } } },
                      'DE': { '1': { single: { supplier: 18.00, client: 24.00 } }, '3': { single: { supplier: 16.00, client: 21.50 } }, '5': { single: { supplier: 14.20, client: 19.00 } } },
                      'FR': { '1': { single: { supplier: 19.00, client: 25.00 } }, '3': { single: { supplier: 17.00, client: 22.50 } }, '5': { single: { supplier: 15.00, client: 20.00 } } }
                    },
                    countries: ['UK', 'DE', 'FR'],
                    quantities: [1, 3, 5],
                    shippingType: 'single'
                  },
                  {
                    id: 'PRD-004',
                    sku: 'MBS-12-PRO',
                    name: 'Makeup Brush Set - 12pc',
                    description: 'Professional makeup brush set with carrying case',
                    client: 'BeautyBliss Store',
                    status: 'active',
                    createdAt: '2024-08-22',
                    totalOrders: 3456,
                    pricing: {
                      'FR': { '1': { single: { supplier: 6.30, client: 8.50 }, upsell: { supplier: 5.20, client: 7.00 } }, '3': { single: { supplier: 5.50, client: 7.50 }, upsell: { supplier: 4.40, client: 6.00 } }, '5': { single: { supplier: 5.00, client: 6.80 }, upsell: { supplier: 4.00, client: 5.50 } }, '10': { single: { supplier: 4.40, client: 6.00 }, upsell: { supplier: 3.50, client: 4.80 } } },
                      'DE': { '1': { single: { supplier: 6.50, client: 8.80 }, upsell: { supplier: 5.40, client: 7.30 } }, '3': { single: { supplier: 5.70, client: 7.80 }, upsell: { supplier: 4.60, client: 6.30 } }, '5': { single: { supplier: 5.10, client: 7.00 }, upsell: { supplier: 4.20, client: 5.70 } }, '10': { single: { supplier: 4.50, client: 6.20 }, upsell: { supplier: 3.60, client: 5.00 } } },
                      'IT': { '1': { single: { supplier: 6.70, client: 9.00 }, upsell: { supplier: 5.60, client: 7.50 } }, '3': { single: { supplier: 5.90, client: 8.00 }, upsell: { supplier: 4.80, client: 6.50 } }, '5': { single: { supplier: 5.30, client: 7.20 }, upsell: { supplier: 4.30, client: 5.90 } }, '10': { single: { supplier: 4.70, client: 6.40 }, upsell: { supplier: 3.80, client: 5.20 } } },
                      'ES': { '1': { single: { supplier: 6.80, client: 9.20 }, upsell: { supplier: 5.70, client: 7.70 } }, '3': { single: { supplier: 6.00, client: 8.20 }, upsell: { supplier: 4.90, client: 6.70 } }, '5': { single: { supplier: 5.40, client: 7.40 }, upsell: { supplier: 4.50, client: 6.10 } }, '10': { single: { supplier: 4.80, client: 6.60 }, upsell: { supplier: 3.90, client: 5.40 } } }
                    },
                    countries: ['FR', 'DE', 'IT', 'ES'],
                    quantities: [1, 3, 5, 10],
                    shippingType: 'both'
                  },
                  {
                    id: 'PRD-005',
                    sku: 'RB-SET-5',
                    name: 'Resistance Band Set',
                    description: '5-piece resistance band set with door anchor',
                    client: 'FitLife Gear',
                    status: 'active',
                    createdAt: '2024-12-01',
                    totalOrders: 956,
                    pricing: {
                      'US': { '1': { single: { supplier: 9.50, client: 12.50 } }, '3': { single: { supplier: 8.20, client: 11.00 } }, '5': { single: { supplier: 7.00, client: 9.50 } } }
                    },
                    countries: ['US'],
                    quantities: [1, 3, 5],
                    shippingType: 'single'
                  },
                  {
                    id: 'PRD-006',
                    sku: 'LSL-100',
                    name: 'LED String Lights - 100ft',
                    description: 'Waterproof LED string lights with remote control',
                    client: 'HomeDecor Haven',
                    status: 'active',
                    createdAt: '2024-07-15',
                    totalOrders: 1876,
                    pricing: {
                      'UK': { '1': { single: { supplier: 14.50, client: 18.99 }, upsell: { supplier: 12.00, client: 15.99 } }, '3': { single: { supplier: 12.50, client: 16.50 }, upsell: { supplier: 10.00, client: 13.50 } }, '5': { single: { supplier: 10.50, client: 14.00 }, upsell: { supplier: 8.50, client: 11.50 } } },
                      'DE': { '1': { single: { supplier: 15.50, client: 19.99 }, upsell: { supplier: 13.00, client: 16.99 } }, '3': { single: { supplier: 13.50, client: 17.50 }, upsell: { supplier: 11.00, client: 14.50 } }, '5': { single: { supplier: 11.50, client: 15.00 }, upsell: { supplier: 9.50, client: 12.50 } } }
                    },
                    countries: ['UK', 'DE'],
                    quantities: [1, 3, 5],
                    shippingType: 'both'
                  },
                  {
                    id: 'PRD-007',
                    sku: 'USB-CABLE-3',
                    name: 'USB-C Cable 3-pack',
                    description: 'Braided USB-C to USB-A cables, 3-pack assorted lengths',
                    client: 'TechGadgets Pro',
                    status: 'active',
                    createdAt: '2024-10-25',
                    totalOrders: 2847,
                    pricing: {
                      'US': { '1': { single: { supplier: 2.60, client: 3.50 }, upsell: { supplier: 2.10, client: 2.80 } }, '3': { single: { supplier: 2.20, client: 3.00 }, upsell: { supplier: 1.80, client: 2.40 } }, '5': { single: { supplier: 1.90, client: 2.60 }, upsell: { supplier: 1.50, client: 2.10 } } },
                      'UK': { '1': { single: { supplier: 2.80, client: 3.80 }, upsell: { supplier: 2.20, client: 3.00 } }, '3': { single: { supplier: 2.40, client: 3.20 }, upsell: { supplier: 1.90, client: 2.60 } }, '5': { single: { supplier: 2.00, client: 2.80 }, upsell: { supplier: 1.70, client: 2.30 } } }
                    },
                    countries: ['US', 'UK'],
                    quantities: [1, 3, 5],
                    shippingType: 'both'
                  }
                ],

                get allClients() {
                  return [...new Set(this.products.map(p => p.client))];
                },

                get filteredProducts() {
                  return this.products.filter(product => {
                    if (this.filterClient !== 'all' && product.client !== this.filterClient) return false;
                    if (this.searchQuery) {
                      const query = this.searchQuery.toLowerCase();
                      return product.name.toLowerCase().includes(query) ||
                             product.sku.toLowerCase().includes(query) ||
                             product.client.toLowerCase().includes(query) ||
                             product.id.toLowerCase().includes(query);
                    }
                    return true;
                  });
                },

                formatCurrency(amount) {
                  if (!amount) return '-';
                  return '$' + parseFloat(amount).toFixed(2);
                },

                formatDate(dateStr) {
                  const date = new Date(dateStr);
                  return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
                },

                getCountryFlag(code) {
                  const flags = { 'US': 'ðŸ‡ºðŸ‡¸', 'UK': 'ðŸ‡¬ðŸ‡§', 'DE': 'ðŸ‡©ðŸ‡ª', 'FR': 'ðŸ‡«ðŸ‡·', 'IT': 'ðŸ‡®ðŸ‡¹', 'ES': 'ðŸ‡ªðŸ‡¸', 'CA': 'ðŸ‡¨ðŸ‡¦', 'AU': 'ðŸ‡¦ðŸ‡º' };
                  return flags[code] || code;
                },

                viewPricing(product) {
                  this.selectedProduct = JSON.parse(JSON.stringify(product));
                  this.pricingModal = true;
                },

                getLowestPrice(product) {
                  let lowest = Infinity;
                  Object.values(product.pricing).forEach(countryPricing => {
                    Object.values(countryPricing).forEach(qtyPricing => {
                      if (qtyPricing.single?.client && qtyPricing.single.client < lowest) lowest = qtyPricing.single.client;
                      if (qtyPricing.upsell?.client && qtyPricing.upsell.client < lowest) lowest = qtyPricing.upsell.client;
                    });
                  });
                  return lowest === Infinity ? null : lowest;
                },

                getHighestPrice(product) {
                  let highest = 0;
                  Object.values(product.pricing).forEach(countryPricing => {
                    Object.values(countryPricing).forEach(qtyPricing => {
                      if (qtyPricing.single?.client && qtyPricing.single.client > highest) highest = qtyPricing.single.client;
                      if (qtyPricing.upsell?.client && qtyPricing.upsell.client > highest) highest = qtyPricing.upsell.client;
                    });
                  });
                  return highest === 0 ? null : highest;
                },

                getMargin(supplier, client) {
                  if (!supplier || !client) return null;
                  return client - supplier;
                },

                getMarginPercent(supplier, client) {
                  if (!supplier || !client || client === 0) return null;
                  return ((client - supplier) / client * 100).toFixed(1);
                }
              }"
            >
              <!-- Header -->
              <div class="mb-6">
                <h2 class="mb-2 text-2xl font-bold text-gray-900 dark:text-white">
                  Products
                </h2>
                <p class="text-sm text-gray-600 dark:text-gray-400">
                  All products with stored quotation pricing
                </p>
              </div>

              <!-- Stats Overview -->
              <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <div class="bg-white dark:bg-gray-800 rounded-lg p-5 border border-gray-200 dark:border-gray-700">
                  <div class="flex items-center justify-between">
                    <div>
                      <p class="text-sm text-gray-600 dark:text-gray-400">Total Products</p>
                      <h3 class="text-2xl font-bold text-gray-900 dark:text-white mt-1" x-text="products.length"></h3>
                    </div>
                    <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center">
                      <svg class="w-6 h-6 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                      </svg>
                    </div>
                  </div>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg p-5 border border-gray-200 dark:border-gray-700">
                  <div class="flex items-center justify-between">
                    <div>
                      <p class="text-sm text-gray-600 dark:text-gray-400">Active Products</p>
                      <h3 class="text-2xl font-bold text-green-600 dark:text-green-400 mt-1" x-text="products.filter(p => p.status === 'active').length"></h3>
                    </div>
                    <div class="w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-lg flex items-center justify-center">
                      <svg class="w-6 h-6 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                      </svg>
                    </div>
                  </div>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg p-5 border border-gray-200 dark:border-gray-700">
                  <div class="flex items-center justify-between">
                    <div>
                      <p class="text-sm text-gray-600 dark:text-gray-400">Clients with Products</p>
                      <h3 class="text-2xl font-bold text-gray-900 dark:text-white mt-1" x-text="allClients.length"></h3>
                    </div>
                    <div class="w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-lg flex items-center justify-center">
                      <svg class="w-6 h-6 text-purple-600 dark:text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                      </svg>
                    </div>
                  </div>
                </div>

                <div class="bg-white dark:bg-gray-800 rounded-lg p-5 border border-gray-200 dark:border-gray-700">
                  <div class="flex items-center justify-between">
                    <div>
                      <p class="text-sm text-gray-600 dark:text-gray-400">Total Orders</p>
                      <h3 class="text-2xl font-bold text-gray-900 dark:text-white mt-1" x-text="products.reduce((sum, p) => sum + p.totalOrders, 0).toLocaleString()"></h3>
                    </div>
                    <div class="w-12 h-12 bg-amber-100 dark:bg-amber-900/30 rounded-lg flex items-center justify-center">
                      <svg class="w-6 h-6 text-amber-600 dark:text-amber-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/>
                      </svg>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Filters Bar -->
              <div class="mb-6 flex flex-wrap items-center gap-4 justify-between">
                <div class="flex flex-wrap items-center gap-4">
                  <!-- Search -->
                  <div class="relative">
                    <input
                      type="text"
                      x-model="searchQuery"
                      placeholder="Search products..."
                      class="py-2 pl-10 pr-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-800 dark:border-gray-700 dark:text-white"
                    />
                    <svg class="absolute left-3 top-2.5 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                    </svg>
                  </div>

                  <!-- Filter by Client -->
                  <select
                    x-model="filterClient"
                    class="py-2 px-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-800 dark:border-gray-700 dark:text-white"
                  >
                    <option value="all">All Clients</option>
                    <template x-for="client in allClients" :key="client">
                      <option :value="client" x-text="client"></option>
                    </template>
                  </select>
                </div>

                <div class="flex gap-3">
                  <button
                    class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors flex items-center gap-2"
                  >
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
                    </svg>
                    Export Pricing
                  </button>
                </div>
              </div>

              <!-- Products Table -->
              <div class="bg-white rounded-lg shadow dark:bg-gray-800 overflow-hidden">
                <div class="overflow-x-auto">
                  <table class="w-full">
                    <thead class="bg-gray-50 dark:bg-gray-700">
                      <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Product</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Client</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Countries</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Price Range</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Type</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Orders</th>
                        <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Actions</th>
                      </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700">
                      <template x-for="product in filteredProducts" :key="product.id">
                        <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 cursor-pointer" @click="viewPricing(product)">
                          <td class="px-6 py-4">
                            <div class="font-medium text-gray-900 dark:text-white" x-text="product.name"></div>
                            <div class="text-xs text-gray-500 dark:text-gray-400" x-text="product.sku"></div>
                          </td>
                          <td class="px-6 py-4">
                            <div class="text-sm text-gray-900 dark:text-white" x-text="product.client"></div>
                          </td>
                          <td class="px-6 py-4">
                            <div class="flex items-center gap-1">
                              <template x-for="country in product.countries" :key="country">
                                <span class="text-base" x-text="getCountryFlag(country)"></span>
                              </template>
                            </div>
                          </td>
                          <td class="px-6 py-4">
                            <div class="text-sm text-gray-900 dark:text-white">
                              <span x-text="formatCurrency(getLowestPrice(product))"></span>
                              <span class="text-gray-400"> - </span>
                              <span x-text="formatCurrency(getHighestPrice(product))"></span>
                            </div>
                          </td>
                          <td class="px-6 py-4">
                            <span
                              class="px-2 py-1 text-xs font-medium rounded-full"
                              :class="product.shippingType === 'both' ? 'bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-400' : 'bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400'"
                              x-text="product.shippingType === 'both' ? 'Single + Upsell' : 'Single Only'"
                            ></span>
                          </td>
                          <td class="px-6 py-4 text-sm text-gray-900 dark:text-white" x-text="product.totalOrders.toLocaleString()"></td>
                          <td class="px-6 py-4 text-right">
                            <button
                              @click.stop="viewPricing(product)"
                              class="px-3 py-1 text-sm text-blue-600 hover:bg-blue-50 rounded dark:text-blue-400 dark:hover:bg-blue-900/30"
                            >
                              View Pricing
                            </button>
                          </td>
                        </tr>
                      </template>
                    </tbody>
                  </table>
                </div>

                <!-- Empty state -->
                <template x-if="filteredProducts.length === 0">
                  <div class="px-6 py-12 text-center">
                    <svg class="mx-auto w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>
                    </svg>
                    <p class="mt-2 text-sm text-gray-600 dark:text-gray-400">No products found</p>
                  </div>
                </template>
              </div>

              <!-- Pricing Modal -->
              <template x-if="pricingModal && selectedProduct">
                <div class="fixed inset-0 z-[99999] flex items-center justify-center p-4 bg-black bg-opacity-50">
                  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
                      <div class="flex items-center justify-between">
                        <div>
                          <h3 class="text-xl font-semibold text-gray-900 dark:text-white" x-text="selectedProduct.name"></h3>
                          <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">
                            <span x-text="selectedProduct.sku"></span> â€¢ <span x-text="selectedProduct.client"></span>
                          </p>
                        </div>
                        <button
                          @click="pricingModal = false"
                          class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"
                        >
                          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                          </svg>
                        </button>
                      </div>
                    </div>
                    <div class="p-6 space-y-6">
                      <!-- Product Info -->
                      <div class="grid grid-cols-3 gap-4 text-sm">
                        <div class="rounded-lg bg-gray-50 p-3 dark:bg-gray-900">
                          <p class="text-gray-500 dark:text-gray-400">Created</p>
                          <p class="mt-1 font-medium text-gray-900 dark:text-white" x-text="formatDate(selectedProduct.createdAt)"></p>
                        </div>
                        <div class="rounded-lg bg-gray-50 p-3 dark:bg-gray-900">
                          <p class="text-gray-500 dark:text-gray-400">Total Orders</p>
                          <p class="mt-1 font-medium text-gray-900 dark:text-white" x-text="selectedProduct.totalOrders.toLocaleString()"></p>
                        </div>
                        <div class="rounded-lg bg-gray-50 p-3 dark:bg-gray-900">
                          <p class="text-gray-500 dark:text-gray-400">Pricing Type</p>
                          <p class="mt-1 font-medium text-gray-900 dark:text-white" x-text="selectedProduct.shippingType === 'both' ? 'Single + Upsell' : 'Single Only'"></p>
                        </div>
                      </div>

                      <div class="rounded-lg border border-gray-200 p-4 dark:border-gray-700">
                        <p class="text-sm text-gray-600 dark:text-gray-400" x-text="selectedProduct.description"></p>
                      </div>

                      <!-- Pricing Matrix -->
                      <div>
                        <h4 class="mb-4 text-lg font-bold text-gray-900 dark:text-white">Stored Pricing Matrix</h4>
                        <p class="mb-4 text-sm text-gray-600 dark:text-gray-400">
                          <span class="text-amber-600 dark:text-amber-400 font-medium">Supplier</span> = our cost from China |
                          <span class="text-green-600 dark:text-green-400 font-medium">Client</span> = what client pays |
                          <span class="text-blue-600 dark:text-blue-400 font-medium">Margin</span> = our profit
                        </p>

                        <template x-for="country in selectedProduct.countries" :key="country">
                          <div class="mb-6">
                            <h5 class="mb-3 flex items-center gap-2 font-semibold text-gray-900 dark:text-white">
                              <span x-text="getCountryFlag(country)"></span>
                              <span x-text="country"></span>
                            </h5>

                            <div class="overflow-x-auto">
                              <table class="w-full text-sm">
                                <thead>
                                  <tr class="border-b border-gray-200 dark:border-gray-700">
                                    <th class="pb-2 text-left font-medium text-gray-600 dark:text-gray-400">Qty</th>
                                    <th class="pb-2 text-center font-medium text-gray-600 dark:text-gray-400" colspan="3">Single Order</th>
                                    <template x-if="selectedProduct.shippingType === 'both'">
                                      <th class="pb-2 text-center font-medium text-gray-600 dark:text-gray-400" colspan="3">Upsell</th>
                                    </template>
                                  </tr>
                                  <tr class="border-b border-gray-100 dark:border-gray-700/50">
                                    <th></th>
                                    <th class="pb-2 text-right text-xs font-medium text-amber-600 dark:text-amber-400">Supplier</th>
                                    <th class="pb-2 text-right text-xs font-medium text-green-600 dark:text-green-400">Client</th>
                                    <th class="pb-2 text-right text-xs font-medium text-blue-600 dark:text-blue-400">Margin</th>
                                    <template x-if="selectedProduct.shippingType === 'both'">
                                      <th class="pb-2 text-right text-xs font-medium text-amber-600 dark:text-amber-400">Supplier</th>
                                    </template>
                                    <template x-if="selectedProduct.shippingType === 'both'">
                                      <th class="pb-2 text-right text-xs font-medium text-green-600 dark:text-green-400">Client</th>
                                    </template>
                                    <template x-if="selectedProduct.shippingType === 'both'">
                                      <th class="pb-2 text-right text-xs font-medium text-blue-600 dark:text-blue-400">Margin</th>
                                    </template>
                                  </tr>
                                </thead>
                                <tbody>
                                  <template x-for="qty in selectedProduct.quantities" :key="qty">
                                    <tr class="border-b border-gray-100 dark:border-gray-700/50">
                                      <td class="py-3 font-medium text-gray-900 dark:text-white" x-text="qty + 'x'"></td>
                                      <!-- Single -->
                                      <td class="py-3 text-right text-amber-600 dark:text-amber-400" x-text="formatCurrency(selectedProduct.pricing[country]?.[qty]?.single?.supplier)"></td>
                                      <td class="py-3 text-right text-green-600 dark:text-green-400 font-medium" x-text="formatCurrency(selectedProduct.pricing[country]?.[qty]?.single?.client)"></td>
                                      <td class="py-3 text-right text-blue-600 dark:text-blue-400">
                                        <span x-text="formatCurrency(getMargin(selectedProduct.pricing[country]?.[qty]?.single?.supplier, selectedProduct.pricing[country]?.[qty]?.single?.client))"></span>
                                        <span class="text-xs text-gray-400" x-text="'(' + getMarginPercent(selectedProduct.pricing[country]?.[qty]?.single?.supplier, selectedProduct.pricing[country]?.[qty]?.single?.client) + '%)'"></span>
                                      </td>
                                      <!-- Upsell -->
                                      <template x-if="selectedProduct.shippingType === 'both'">
                                        <td class="py-3 text-right text-amber-600 dark:text-amber-400" x-text="formatCurrency(selectedProduct.pricing[country]?.[qty]?.upsell?.supplier)"></td>
                                      </template>
                                      <template x-if="selectedProduct.shippingType === 'both'">
                                        <td class="py-3 text-right text-green-600 dark:text-green-400 font-medium" x-text="formatCurrency(selectedProduct.pricing[country]?.[qty]?.upsell?.client)"></td>
                                      </template>
                                      <template x-if="selectedProduct.shippingType === 'both'">
                                        <td class="py-3 text-right text-blue-600 dark:text-blue-400">
                                          <span x-text="formatCurrency(getMargin(selectedProduct.pricing[country]?.[qty]?.upsell?.supplier, selectedProduct.pricing[country]?.[qty]?.upsell?.client))"></span>
                                          <span class="text-xs text-gray-400" x-text="'(' + getMarginPercent(selectedProduct.pricing[country]?.[qty]?.upsell?.supplier, selectedProduct.pricing[country]?.[qty]?.upsell?.client) + '%)'"></span>
                                        </td>
                                      </template>
                                    </tr>
                                  </template>
                                </tbody>
                              </table>
                            </div>
                          </div>
                        </template>
                      </div>
                    </div>
                    <div class="p-6 border-t border-gray-200 dark:border-gray-700 flex justify-between">
                      <button
                        class="px-4 py-2 text-blue-600 hover:bg-blue-50 rounded-lg dark:text-blue-400 dark:hover:bg-blue-900/30"
                      >
                        Edit Pricing
                      </button>
                      <button
                        @click="pricingModal = false"
                        class="px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 dark:bg-gray-700 dark:text-gray-300 dark:border-gray-600 dark:hover:bg-gray-600"
                      >
                        Close
                      </button>
                    </div>
                  </div>
                </div>
              </template>

            </div>
          </div>
        </main>
        <!-- ===== Main Content End ===== -->
      </div>
      <!-- ===== Content Area End ===== -->
    </div>
    <!-- ===== Page Wrapper End ===== -->
  </body>
</html>
